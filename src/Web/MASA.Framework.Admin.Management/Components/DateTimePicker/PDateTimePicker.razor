@namespace MASA.Framework.Admin.Management.Components
@typeparam TValue

<MMenu Value="_menuValue"
       ValueChanged="MenuValueChanged"
       CloseOnContentClick="false"
       CloseOnClick="@(!TimeFocused)"
       MinWidth="@("auto")"
       OffsetY>
    <ActivatorContent>
        @{
            var attrs = context.Attrs
                .Concat(Attributes)
                .ToDictionary(kv => kv.Key, kv => kv.Value);
        }

        <MTextField Dense="Dense"
                    Disabled="Disabled"
                    HideDetails="@HideDetails"
                    Label="@Label"
                    Outlined="@Outlined"
                    PrependIcon="@PrependIcon"
                    PrependInnerIcon="@PrependInnerIcon"
                    Readonly
                    Value="@TextFieldValue"
                    Clearable="Clearable"
                    OnClearClick="HandleOnClearClick"
                    OnKeyDown="OnKeyDown"
                    @attributes="@attrs">
        </MTextField>
    </ActivatorContent>
    <ChildContent>
        <DateTimePicker Value="InternalValue"
                        ValueChanged="InternalValueChanged"
                        TValue="DateTime?"
                        NoTitle="NoTitle"
                        OnHourBlur="OnHourBlur"
                        OnHourFocus="OnHourFocus"
                        OnMinuteBlur="OnMinuteBlur"
                        OnMinuteFocus="OnMinuteFocus"
                        OnSecondBlur="OnSecondBlur"
                        OnSecondFocus="OnSecondFocus">
            <MButton Text Color="primary" OnClick="() => UpdateInternalValue(DateTime.Now)">此刻</MButton>
            <MSpacer></MSpacer>
            <MButton Text OnClick="HandleOnCancel">取消</MButton>
            <MButton Text Color="primary" OnClick="HandleOnOk">确认</MButton>
        </DateTimePicker>
    </ChildContent>
</MMenu>